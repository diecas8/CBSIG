<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa con Capas GeoJSON</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <style>
        #map {
            height: 600px;
            width: 100%;
        }
    </style>
</head>
<body>
    <h1>Mapa Interactivo con Capas GeoJSON</h1>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script>
        // Inicialización del mapa
        var map = L.map("map").setView([13.4977, -83.1513], 8); // Ajusta las coordenadas y el zoom a tu preferencia

        // Definición de las capas de fondo del mapa
        L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
        }).addTo(map);

        // Variables para las capas
        var overlayMaps = {};

        // Función para cargar los archivos GeoJSON desde el repositorio
        function cargarSitios() {
            fetch("file:///H:/Mi unidad/PNUD_FEMNCAFE/geojson naturalpaz/Sitios.geojson")
                .then(response => response.json())
                .then(data => {
                    const sitiosLayer = L.geoJSON(data, {
                        style: { color: "purple", weight: 2, fillOpacity: 0.4 },
                        onEachFeature: (feature, layer) => {
                            const { nombre, tipo } = feature.properties;
                            layer.bindPopup(`<b>Nombre:</b> ${nombre}<br><b>Tipo:</b> ${tipo}`);
                        }
                    });
                    overlayMaps["Sitios"] = sitiosLayer;
                    sitiosLayer.addTo(map);
                    actualizarControlCapas();
                })
                .catch(error => console.error("Error al cargar la capa de sitios:", error));
        }

        function cargarCercas() {
            fetch("file:///H:/Mi unidad/PNUD_FEMNCAFE/geojson naturalpaz/cercas.geojson")
                .then(response => response.json())
                .then(data => {
                    const cercasLayer = L.geoJSON(data, {
                        style: { color: "orange", weight: 2, fillOpacity: 0.2 }
                    });
                    overlayMaps["Cercas"] = cercasLayer;
                    cercasLayer.addTo(map);
                    actualizarControlCapas();
                })
                .catch(error => console.error("Error al cargar la capa de cercas:", error));
        }

        function cargarFincas() {
            fetch("file:///H:/Mi unidad/PNUD_FEMNCAFE/geojson naturalpaz/Fincas.geojson")
                .then(response => response.json())
                .then(data => {
                    const fincasLayer = L.geoJSON(data, {
                        style: { color: "blue", weight: 2, fillOpacity: 0.1 },
                        onEachFeature: (feature, layer) => {
                            const { cod_finca, nom_finca_, area } = feature.properties;
                            layer.bindPopup(`
                                <b>Finca:</b> ${nom_finca_}<br>
                                <b>Código:</b> ${cod_finca}<br>
                                <b>Área:</b> ${parseFloat(area).toFixed(2)} ha
                            `);
                        }
                    });
                    overlayMaps["Fincas"] = fincasLayer;
                    fincasLayer.addTo(map);
                    actualizarControlCapas();
                })
                .catch(error => console.error("Error al cargar la capa de fincas:", error));
        }

        function cargarHmpPol() {
            fetch("file:///H:/Mi unidad/PNUD_FEMNCAFE/geojson naturalpaz/Hmp_pol.geojson")
                .then(response => response.json())
                .then(data => {
                    const hmpPolLayer = L.geoJSON(data, {
                        style: { color: "red", weight: 2, fillOpacity: 0.1 }
                    });
                    overlayMaps["Hmp_pol"] = hmpPolLayer;
                    hmpPolLayer.addTo(map);
                    actualizarControlCapas();
                })
                .catch(error => console.error("Error al cargar la capa de Hmp_pol:", error));
        }

        // Función para actualizar el control de capas
        function actualizarControlCapas() {
            L.control.layers(null, overlayMaps, { collapsed: false }).addTo(map);
        }

        // Llamar a las funciones para cargar los GeoJSON al iniciar
        cargarSitios();
        cargarCercas();
        cargarFincas();
        cargarHmpPol();
    </script>
</body>
</html>
